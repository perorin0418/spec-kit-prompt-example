/constitution  
以下は「PhotoStream」プロジェクトの憲法（Constitution）です。

---  
# プロジェクト憲法（Constitution）  
## 1. ミッションおよび価値観  
- プロジェクト名：PhotoStream（フォトストリーム）  
- 目的／価値提供：ユーザーが撮影した写真を日付ごとに整理し、ドラッグ＆ドロップ操作でアルバム共有ができる軽量Webアプリケーションを提供する。  
- チームの価値観：保守性、ユーザビリティ、パフォーマンス、アクセシビリティ、コードの明瞭さ。

## 2. コード・アーキテクチャに関する原則  
### I. 技術選定  
- 主な技術スタック：React 18 + TypeScript、ビルドツールにVite、メタデータ管理にSQLite（Prisma経由）、バックエンドAPIにNode.js 20。  
- 新規ライブラリ採用条件：チーム内で議論のうえ決定すること。npmで10万DL以上、かつ12ヶ月以内に更新実績があるもの。採用前にfeatureブランチで試験導入を行う。

### II. コード品質とテスト  
- テスト方針：新規機能にはユニットテストと統合テストを必ず含める。新規モジュールはカバレッジ90%以上を目標とする。全てのPRには他のエンジニア1名以上によるコードレビューが必要。  
- コーディングスタイル：Prettier＋ESLintを使用。命名規則は変数・関数＝camelCase、コンポーネント・クラス＝PascalCase。公開関数にはJSDocコメントを付与。

### III. 設計と保守性  
- 設計原則：SOLID原則を遵守。各モジュールは単一責任を持ち、深い依存関係を避ける。サービス層はテスト容易性のため依存注入を採用。  
- 非機能要件：3G環境でページ読み込み2秒以内を目標。WCAG 2.1 AA準拠のアクセシビリティを確保。顧客データは保存時・通信時ともに暗号化。APIにはレートリミットを実装。

## 3. プロセスとガバナンス  
### I. ブランチ／コミット／タスク構成  
- ブランチ戦略：`main`ブランチは保護対象。各機能は`feature/<feature-id>-description`形式。リリース専用ブランチはホットフィックス時のみ作成。  
- コミットメッセージ形式：`<タスクID>: <短い説明>` 例：`T045: アルバムのドラッグ＆ドロップ対応を追加`。コミットは小さく、機能単位で複数回行う。  
- タスクID管理：`T###`形式（例：T001, T002…）。全コミットにタスクIDを紐付けること。

### II. レビューと承認プロセス  
- PR（プルリクエスト）基準：すべてのテストが成功していること、カバレッジが維持されていること、1名以上のレビューを経ていること。レビュー担当者は憲法準拠を確認する。  
- 憲法からの逸脱：やむを得ない場合は「例外申請」として、該当箇所と理由を明記し、チームリードの承認を得ること。

### III. 憲法の改定  
- 改定タイミング：四半期ごと、または技術スタックの変更など大きな構造変化が発生した場合。改定にはチームメンバーの3分の2以上の同意が必要。改定履歴は`constitution.md`に追記する。  
- 優先順位：この憲法はすべてのガイドライン・設計方針より優先される。例外は「改定」または「承認済み逸脱」に限る。

## 4. 非交渉的な制約（Must-haves）  
- すべての顧客向け機能には自動テストを実装する。  
- UIはWCAG 2.1 AA準拠のアクセシビリティを満たす。  
- すべてのタイムスタンプはUTCを使用。  
- ユーザーデータはAES-256で暗号化保存、TLS通信で送信。  
- ストレージはベンダーロックインを避け、クラウド非依存の設計を行う。

## 5. チーム行動規範  
- チーム内外での議論はオープンかつ敬意をもって行う。  
- 「ドキュメントファースト」文化を重視し、コードよりも先に設計や仕様を明文化する。  
- リリースごとに振り返り（レトロスペクティブ）を実施し、学びをチームナレッジに蓄積する。  
- 試験的な取り組み（PoCやスパイク開発）は歓迎するが、明示的にラベル付けし、期間を限定する。

---  
※この憲法は `/speckit.specify`、`/speckit.plan`、`/speckit.tasks`、`/speckit.implement` の各フェーズにおいて参照されます。  
憲法に反する提案や実装を行う場合は、明示的な「例外承認」を必要とします。
